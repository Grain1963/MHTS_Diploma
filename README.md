# MHTS_Diploma
МГТУ им. Н.Э. Баумана
группа 11784/2 
апрель 2023 г

Выпускная Квалификационная Работа 

Тема: “Прогнозирование конечных свойств новых материалов (композиционные материалы)”

По курсу обучения “Data Science”

Слушатель Григорьев С.А.

Весь проект осуществлен в JupyterLab, версия Python- 3.10

В процессе написания ВКР: 
Изучены теоретические основы и методы решения поставленной задачи.
Для сокращения длины рабочего кода, часто повторяющиеся части кода собраны в вызываемые модули-функции, которые сохранены в директории modules_def.

В процессе работы все получаемые графики сохранялись в директории save_fig/fig_blockN, а получаемые в процессе работы по Блокам DataFrame (далее df) в директорию data_storage/data_blockN,  где N -номер Блока части исследования  от 1 до 5.

Получен полный отчет profile_report_composites.html (записан в директорию profile_report) по исходному объединенному df   и отчет profile_report_composites_clean_outliers.html,   по очищенному от выбросов df data_main_clean.csv.

Рабочий Проект разделен на 5 частей:

1.Diploma_block1_clean.ipynb:
- Проведено объединение двух входных df в один по методу INNER.
- Проведена замена названий параметров с русского языка на английский.
- Проведен разведочный анализ предложенных данных. 
- Продемонстрированы гистограммы распределения каждой из переменной, диаграммы ящика с усами, матричные графики рассеяния точек. 
- Для каждого параметра получены среднее, медианное значение, проверено наличие пропусков, проведен итерационный анализ и исключение выбросов несколькими методами. 
 - Осуществлена замена “подозрительных значений” на средние значения ближайших 5 соседей.  
- По результатам работы в Блоке № 1 для дальнейшего исследования создан очищенный от выбросов df data_main_clean.csv,  который записан в папку data_block1_clean, которая входит в директорию верхнего уровня  data_storage. 
- Все полученные графики  сохранены в директории save_fig/ fig_block1_clean.

2. Diploma_block2_corr.ipynb:
- Проведено исследование корреляционных матриц очищенного от выбросов и подозрительных значений df в зависимости от количества значений в выборке. 
-Сделан вывод, что при рассмотрении полного df корреляция отсутствует практически полностью, однако при значениях N = 100 и 200 еще наблюдается некоторая корреляционная зависимость между параметрами, с увеличением числа выборки зависимость падает до около нулевых значений.
- Проведен графический анализ использованием регрессионной прямой по каждому параметру с целевыми переменными “Модуля упругости при растяжении” и “Прочности при растяжении”.
- На основании теоретических исследований, приведенных в научной литературе по данной теме Введен новый параметр ALFA как функция Модуля упругости при растяжении и Прочности при растяжении.
- Произведен выбор фитчей для наших целевых параметров, что позволит сократить вычислительные ресурсы и увеличить точность расчетов.
- Подготовлен df data_Train_ML.csv из 200 случайных значений (random_state=42) в качестве  обучающего массива для регрессионного анализ в оке 3 и df data_Test_ML.csv для использования в качестве тестового набора данных (random_state=50).  Полученные df записаны в соответствующую директорию data_storage/data_block2_corr.
- Полученные в процессе работы Блока 2 графики записаны в соответствующую директорию save_fig/fig_block2_corr

3. Diploma_block3_regress.ipynb:
- Проведена предобработка данных, нормализация и стандартизация.
- Обучены 6 типов моделей для прогноза модуля упругости при растяжении и прочности при растяжении.
- Получены и сведены в 2 df : df_error_calc_EMS.csv и df_error_calc_SS.csv  значения  по 7 оценочным параметрам работы разных моделей регрессии и записаны в директорию data_storage/data_block3_regress.
- Сделан вывод о практическом отсутствии регрессии между параметрами и целевой переменной “Модуль упругости при растяжении’ и невозможно прогнозировать этот целевой параметр по имеющемуся набору данных.
- В тоже время по целевому показателю ‘Прочность при растяжении’ считаю вполне возможно на небольшом датасете проводить прогнозирование результата с довольно большой точностью!
- Полученные в процессе работы Блока 3 графики записаны в соответствующую директорию save_fig/fig_block3_regress.

4. Diploma_block4_neuro.ipynb:
- Для работы с нейросетью был применен полный очищенный от выбросов df df data_main_clean.csv, который получен в Блоке №1.
- Проведен обоснованный расчет количества слоев нейронной сети, количества нейронов в каждом слое и выбор активационных функции для каждого слоя.
- Написана нейронная сеть, которая будет рекомендовать соотношение целевого параметра “Матрица-наполнитель”.
- Оценены точности моделей на тренировочном и тестовом датасете.
- Полученная и обученная модел нейронной сети была сохранена в директории data_storage/data_block5_neuro/model_RFM_flask.
- Полученные в процессе работы Блока 4 графики записаны в соответствующую директорию save_fig/fig_block4_neuro.

5. Diploma_block5_flask (папка):
- Блок создания приложения в модуле FLASK по прогнозированию целевого параметра Соотношение матрица-наполнитель.
- Создано приложение app.py и запущено в работу. Результаты отработанного приложения приведены в конце файла.  В процессе работы приложения Пользователь заносит рабочие значения параметров, а Приложение сначала нормализует данные, затем передает их в сохраненную модель, а после этого инверсирует расчетные значения в обычныую размерность парамтера "Соотношение матрица-наполнитель".
- Создан шаблон сайта - файл   main.html в папке templates
- В папке templates расположен снимок с экрана рабочего прилоения на рабочем локальном хосте http://127.0.0.1:5000

По итогам работ над Проектом был создан репозиторий на web ресурсе GitHub, в котором выложены все материалы. Ссылка на репозиторий: https://github.com/Grain1963/MHTS_Diploma. 
